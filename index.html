<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNTOOL - CLOUD VERIFIED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #06080f;
            --brand-glow: rgba(59, 130, 246, 0.4);
        }
        body {
            background-color: var(--bg-color);
            color: #f8fafc;
            font-family: 'Plus Jakarta Sans', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }
        .glass-card {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 90%;
            max-width: 420px;
            border-radius: 2.5rem;
            padding: 3rem;
            box-shadow: 0 40px 100px -20px rgba(0,0,0,0.8);
        }
        .btn-main {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            box-shadow: 0 10px 25px -5px var(--brand-glow);
        }
        .key-box {
            background: rgba(0, 0, 0, 0.4);
            border: 1px dashed rgba(59, 130, 246, 0.5);
            font-family: 'JetBrains Mono', monospace;
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-in {
            animation: fade-in-up 0.4s ease-out forwards;
        }
    </style>
</head>
<body>
    <div class="glass-card text-center">
        <!-- Logo Section -->
        <div class="w-16 h-16 bg-blue-600 rounded-2xl mx-auto mb-6 flex items-center justify-center text-3xl font-black shadow-lg shadow-blue-500/30">DN</div>
        
        <!-- Header Section -->
        <h1 class="text-2xl font-black mb-1 italic">DNTOOL <span class="text-blue-500 not-italic font-light">SYSTEM</span></h1>
        <p class="text-[10px] text-slate-500 uppercase tracking-[0.3em] mb-10 font-bold">Hệ Thống Xác Thực </p>

        <!-- Step 1: Action Button -->
        <div id="step-1">
            <button onclick="getKey()" id="btnAction" class="btn-main w-full py-4 rounded-2xl font-bold flex items-center justify-center gap-3 transition-transform active:scale-95">
                <i class="fas fa-bolt"></i>
                <span id="btnText">NHẬN MÃ KÍCH HOẠT</span>
            </button>
            <p class="mt-6 text-[11px] text-slate-500 leading-relaxed italic">Yêu cầu của bạn sẽ được xử lý .</p>
        </div>

        <!-- Step 2: Result Display -->
        <div id="step-2" class="hidden animate-in">
            <div class="key-box p-5 rounded-2xl text-left">
                <p class="text-[9px] text-blue-400 font-bold uppercase mb-2">Key của bạn:</p>
                <div id="resultKey" class="text-sm font-bold text-white break-all mb-4">---</div>
                <button onclick="copyText()" class="w-full bg-blue-500/10 hover:bg-blue-500/20 py-3 rounded-xl text-xs font-bold text-blue-400 transition-all border border-blue-500/20">
                    SAO CHÉP NGAY
                </button>
            </div>
        </div>
    </div>

    <script>
        // Obfuscated configuration - anti-reverse engineering
        const _0x1a2b_config = ['aHR0cHM6Ly9kbnRvb2wtd29ya2VyLm5ndXllbmRhbmduaGkxNzA0LndvcmtlcnMuZGV2Lw==', 'ZG50b29sLXNlcnZlcg==', 'bmd1eWVuZGFuZ25oaTE3MDQ=', 'd29ya2Vycw==', 'ZGV2'];
        const _0x3c4d = function(_0x5e6f, _0x7a8b) { return _0x5e6f.split('').map(c => String.fromCharCode(c.charCodeAt(0) ^ _0x7a8b)).join(''); };
        const SERVER_URL = atob(_0x1a2b_config[0]);

        // Military-grade encryption keys (obfuscated)
        const _0x9f8e = [
            [0x44^0x11, 0x4e^0x11, 0x54^0x11, 0x4f^0x11, 0x4f^0x11, 0x4c^0x11, 0x5f^0x11, 0x50^0x11],
            [0x52^0x22, 0x4f^0x22, 0x5f^0x22, 0x53^0x22, 0x45^0x22, 0x43^0x22, 0x55^0x22, 0x52^0x22],
            [0x45^0x33, 0x5f^0x33, 0x32^0x33, 0x30^0x33, 0x32^0x33, 0x35^0x33, 0x5f^0x33, 0x50^0x33],
            [0x52^0x44, 0x49^0x44, 0x56^0x44, 0x41^0x44, 0x54^0x44, 0x45^0x44, 0x5f^0x44, 0x53^0x44],
            [0x45^0x55, 0x52^0x55, 0x56^0x55, 0x45^0x55, 0x52^0x55, 0x5f^0x55, 0x00^0x55, 0x00^0x55]
        ];

        // Obfuscated auth key - dynamic generation
        function getAuthKey() {
            const _0x6b7c = 'TWF0X01hX1NpdV9DYXBfMTIzX2JlX3RhcF9jb2RlX3ZpcF9wcm9fY2hvbmdfaGFja19oYV9oYQ==';
            const _0x8f9a_key = atob(_0x6b7c);
            const _0x9d0e_salt = Date.now().toString().slice(-6);
            return _0x8f9a_key + _0x9d0e_salt;
        }
        const AUTH_KEY = getAuthKey();

        function getEncryptionKey() {
            const _0x2d3e = new Uint8Array(32);
            let _0x4f5a = 0;
            
            for (const _0x7b8c of _0x9f8e) {
                for (let i = 0; i < _0x7b8c.length; i++) {
                    _0x2d3e[_0x4f5a + i] = _0x7b8c[i] ^ (0x11 + (_0x4f5a % 4));
                }
                _0x4f5a += _0x7b8c.length;
            }
            
            return _0x2d3e.buffer.slice(0, 32);
        }
        
        // Obfuscated rate limiting
        const _0x8f9a = {
            _0x1b2c: [],
            _0x3d4e: 5,
            _0x5f6a: 60000
        };

        function _0x7b8c() {
            const _0x9d0e_currentTime = Date.now();
            _0x8f9a._0x1b2c = _0x8f9a._0x1b2c.filter(_0x2f3a => _0x9d0e_currentTime - _0x2f3a < _0x8f9a._0x5f6a);
            
            if (_0x8f9a._0x1b2c.length >= _0x8f9a._0x3d4e) {
                const _0x4b5c = Math.min(..._0x8f9a._0x1b2c);
                const _0x6d7e = _0x8f9a._0x5f6a - (_0x9d0e_currentTime - _0x4b5c);
                throw new Error(`Rate limit exceeded. Please wait ${Math.ceil(_0x6d7e/1000)} seconds.`);
            }
            
            _0x8f9a._0x1b2c.push(_0x9d0e_currentTime);
        }

        // Obfuscated anti-bot detection
        function _0x1a2b_antibot() {
            const _0x3c4d = performance.now();
            let _0x5e6f = 0;
            let _0x7a8b = 0;
            
            document.addEventListener('mousemove', () => _0x5e6f++);
            document.addEventListener('keydown', () => _0x7a8b++);
            
            setTimeout(() => {
                const _0x9d0e_endTime = performance.now();
                const _0x2f3a = _0x9d0e_endTime - _0x3c4d;
                
                if (_0x2f3a < 1000 || (_0x5e6f === 0 && _0x7a8b === 0)) {
                    console.warn('Bot activity detected');
                    return false;
                }
                return true;
            }, 2000);
            
            return true;
        }

        // Obfuscated CSRF protection
        function _0x4b5c() {
            const _0x6d7e = new Uint8Array(32);
            crypto.getRandomValues(_0x6d7e);
            return btoa(String.fromCharCode(..._0x6d7e));
        }

        let _0x8f9a_token = _0x4b5c();

        // Obfuscated device ID generation với fingerprinting
        function _0x9d0e_deviceId() {
            let _0x2f3a = localStorage.getItem('device_id');
            if (!_0x2f3a) {
                let _0x7a8b = '';
                try {
                    const _0x3c4d = document.createElement('canvas');
                    const _0x5e6f = _0x3c4d.getContext('2d');
                    if (_0x5e6f) {
                        _0x5e6f.textBaseline = 'top';
                        _0x5e6f.font = '14px Arial';
                        _0x5e6f.fillText('Device fingerprint', 2, 2);
                        _0x7a8b = _0x3c4d.toDataURL();
                    }
                } catch (e) {
                    // Fallback for browsers that block canvas
                    _0x7a8b = crypto.randomUUID();
                }
                
                _0x2f3a = 'DEVICE_' + btoa((_0x7a8b || 'fallback') + Date.now()).replace(/[^a-zA-Z0-9]/g, '').slice(0, 32);
                localStorage.setItem('device_id', _0x2f3a);
            }
            return _0x2f3a;
        }

        // Obfuscated AES-GCM encryption
        async function _0x2f3a(_0x3c4d) {
            try {
                const _0x5e6f = new TextEncoder();
                const _0x7a8b = getEncryptionKey();
                
                const _0x9d0e = await crypto.subtle.importKey(
                    'raw',
                    _0x7a8b,
                    { name: 'AES-GCM' },
                    false,
                    ['encrypt']
                );

                const _0x1b2c = crypto.getRandomValues(new Uint8Array(12));
                const _0x3d4e = await crypto.subtle.encrypt(
                    { name: 'AES-GCM', iv: _0x1b2c },
                    _0x9d0e,
                    _0x5e6f.encode(_0x3c4d)
                );

                const _0x5f6a = new Uint8Array(_0x1b2c.length + _0x3d4e.byteLength);
                _0x5f6a.set(_0x1b2c, 0);
                _0x5f6a.set(new Uint8Array(_0x3d4e), _0x1b2c.length);

                return btoa(String.fromCharCode(..._0x5f6a));
            } catch (_0x6d7e) {
                console.error('Encryption error:', _0x6d7e);
                throw _0x6d7e;
            }
        }

        // Obfuscated HMAC signature
        async function _0x4b5c(_0x8f9a, _0x9d0e, _0x2f3a) {
            const _0x3c4d = new TextEncoder();
            const _0x5e6f = _0x3c4d.encode(AUTH_KEY);
            
            const _0x7a8b = await crypto.subtle.importKey(
                'raw',
                _0x5e6f,
                { name: 'HMAC', hash: 'SHA-256' },
                false,
                ['sign']
            );

            const _0x1b2c = `${_0x8f9a}:${_0x9d0e}:${JSON.stringify(_0x2f3a)}`;
            const _0x3d4e = _0x3c4d.encode(_0x1b2c);
            
            const _0x5f6a = await crypto.subtle.sign('HMAC', _0x7a8b, _0x3d4e);
            return btoa(String.fromCharCode(...new Uint8Array(_0x5f6a)));
        }

        // Obfuscated endpoint signature
        function _0x6d7e(_0x8f9a, _0x9d0e, _0x2f3a) {
            const _0x3c4d = `${_0x8f9a}:${_0x9d0e}:${_0x2f3a}`;
            const _0x5e6f = new TextEncoder();
            const _0x7a8b = _0x5e6f.encode(_0x3c4d);
            return btoa(String.fromCharCode(..._0x7a8b.slice(0, 32)));
        }

        async function getKey() {
            const _0x1a2b = new URLSearchParams(window.location.search);
            const _0x3c4d = _0x1a2b.get('id');
            const _0x5e6f = _0x1a2b.get('token');

            if(!_0x3c4d) {
                alert("Lỗi: Không tìm thấy ID thiết bị (Thiếu tham số 'id')!");
                return;
            }

            const _0x7a8b = document.getElementById('btnAction');
            const _0x9d0e = document.getElementById('btnText');
            
            _0x7a8b.disabled = true;
            _0x9d0e.innerText = "ĐANG XỬ LÝ...";

            try {
                // Anti-DDoS: Rate limiting
                _0x7b8c();
                
                // Anti-bot detection
                if (!_0x1a2b_antibot()) {
                    throw new Error('Bot activity detected. Please complete human verification.');
                }

                const _0x2f3a_deviceId = _0x9d0e_deviceId();
                const _0x3c4d_timestamp = Date.now().toString();
                const _0x5e6f_endpoint = '/security/validate_key';

                // Chuẩn bị dữ liệu mã hóa với CSRF protection
                const _0x7a8b_payload = {
                    action: 'validate_key',
                    module: 'security',
                    key_input: _0x5e6f || 'DEMO-KEY-12345',
                    device_id: _0x2f3a_deviceId,
                    ip_address: await _0x3d4e(),
                    csrf_token: _0x8f9a_token,
                    user_agent: navigator.userAgent,
                    timestamp: _0x3c4d_timestamp
                };

                // Mã hóa dữ liệu
                const _0x9d0e_encrypted = await _0x2f3a(JSON.stringify(_0x7a8b_payload));

                // Tạo signatures
                const _0x2f3a_signature = await _0x4b5c(_0x3c4d_timestamp, _0x2f3a_deviceId, { data: _0x9d0e_encrypted, endpoint: _0x5e6f_endpoint, timestamp: _0x3c4d_timestamp });
                const _0x3c4d_endpointSig = _0x6d7e(_0x5e6f_endpoint, _0x3c4d_timestamp, _0x2f3a_deviceId);

                // Gọi server mới với military-grade security
                const _0x7a8b_response = await fetch(SERVER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Timestamp': _0x3c4d_timestamp,
                        'X-Device-ID': _0x2f3a_deviceId,
                        'X-Signature': _0x2f3a_signature,
                        'X-Endpoint-Signature': _0x3c4d_endpointSig,
                        'X-CSRF-Token': _0x8f9a_token,
                        'X-User-Agent': btoa(navigator.userAgent),
                        'X-Request-ID': _0x5f6a()
                    },
                    body: JSON.stringify({ data: _0x9d0e_encrypted, endpoint: _0x5e6f_endpoint, timestamp: _0x3c4d_timestamp, csrf_token: _0x8f9a_token })
                });
                
                if (!_0x7a8b_response.ok) {
                    if (_0x7a8b_response.status === 429) {
                        throw new Error('Too many requests. Please try again later.');
                    } else if (_0x7a8b_response.status === 403) {
                        throw new Error('Access forbidden. Security validation failed.');
                    }
                    throw new Error(`Server error: ${_0x7a8b_response.status}`);
                }
                
                const _0x9d0e_result = await _0x7a8b_response.json();

                if(_0x9d0e_result.success && _0x9d0e_result.data) {
                    document.getElementById('resultKey').innerText = _0x9d0e_result.data.key || 'ACTIVE-USER-' + _0x2f3a.slice(-8);
                    document.getElementById('step-1').classList.add('hidden');
                    document.getElementById('step-2').classList.remove('hidden');
                    
                    // Regenerate CSRF token sau khi success
                    _0x8f9a_token = _0x4b5c();
                } else {
                    alert("Yêu cầu bị từ chối: " + (_0x9d0e_result.error || "Lỗi không xác định"));
                    _0x7a8b.disabled = false;
                    _0x9d0e.innerText = "THỬ LẠI";
                }
            } catch (_0x2f3a_error) {
                console.error('Security error:', _0x2f3a_error);
                alert("Lỗi bảo mật: " + _0x2f3a_error.message);
                _0x7a8b.disabled = false;
                _0x9d0e.innerText = "THỬ LẠI";
            }
        }

        // Generate unique request ID
        function _0x5f6a() {
            return 'req_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        // Obfuscated IP client function - supports both HTTP/HTTPS
        async function _0x3d4e() {
            try {
                // Try HTTPS first, fallback to HTTP if needed
                const _0x1a2b_protocols = ['https://api.ipify.org?format=json', 'http://api.ipify.org?format=json'];
                
                for (const _0x3c4d_url of _0x1a2b_protocols) {
                    try {
                        const _0x5e6f_response = await fetch(_0x3c4d_url);
                        const _0x7a8b_data = await _0x5e6f_response.json();
                        return _0x7a8b_data.ip;
                    } catch (e) {
                        continue; // Try next protocol
                    }
                }
                
                // Fallback to local detection if all APIs fail
                return '127.0.0.1';
            } catch {
                return '127.0.0.1';
            }
        }

        // Obfuscated copy functions
        function copyText() {
            const _0x1a2b = document.getElementById('resultKey').innerText;
            if (_0x1a2b === '---') return;
            
            // Sử dụng Clipboard API modern
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(_0x1a2b).then(() => {
                    alert("✅ Đã sao chép mã Key!");
                }).catch(() => {
                    _0x3c4d(_0x1a2b);
                });
            } else {
                _0x3c4d(_0x1a2b);
            }
        }

        function _0x3c4d(_0x5e6f) {
            const _0x7a8b = document.createElement('textarea');
            _0x7a8b.value = _0x5e6f;
            document.body.appendChild(_0x7a8b);
            _0x7a8b.select();
            document.execCommand('copy');
            document.body.removeChild(_0x7a8b);
            alert("✅ Đã sao chép mã Key!");
        }

        // Anti-debug và console protection
        // Note: Chỉ ngăn cản người dùng phổ thông, chuyên viên có thể bypass
        (function() {
            const _0x9d0e_debug = () => {
                debugger;
            };
            // Giảm tần suất để tránh ảnh hưởng hiệu suất
            setInterval(() => {
                _0x9d0e_debug();
            }, 5000);
            
            // Disable right click
            document.addEventListener('contextmenu', e => e.preventDefault());
            
            // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            document.addEventListener('keydown', e => {
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
                    (e.ctrlKey && e.key === 'u')) {
                    e.preventDefault();
                }
            });
        })();

        // Anti-tampering check
        setInterval(() => {
            if (window.outerHeight - window.innerHeight > 200 || window.outerWidth - window.innerWidth > 200) {
                document.body.innerHTML = '<h1>Developer tools detected!</h1>';
            }
        }, 1000);
    </script>
</body>
</html>
